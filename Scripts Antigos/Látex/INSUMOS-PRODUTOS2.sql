CREATE TABLE LINHABABYPOP60X130X08 (
  CODIGO INT PRIMARY KEY IDENTITY (1,1) NOT NULL, -->CHAVE PRIMARIA
  COD_INSUMO INT FOREIGN KEY REFERENCES INSUMOS(COD_INSUMO)NOT NULL, -->CHAVE ESTRANGEIRA
  QTD_INSUMO FLOAT,
  PRECO_TOTAL_INSUMO FLOAT,
  PRECO_TOTAL_PRODUTO FLOAT )

INSERT INTO INSUMOS VALUES('114','EMBALAGEM','EMB. ALTA 70X150X04 BERCO 6 E 8','UN','0.21');	
INSERT INTO INSUMOS VALUES('211','ETIQUETA','BABY POP 60 X 130 X 08','UN','0.04');	
INSERT INTO INSUMOS VALUES('239','FITIM','TNT 45 GR PARA FITIM','	MT','0.018');	
INSERT INTO INSUMOS VALUES('252','LINHA','LINHA 120 RETA','UN','0.20');	
INSERT INTO INSUMOS VALUES('282','PLACA DE ESPUMA','POP','M3','52.49');	
INSERT INTO INSUMOS VALUES('303','PLASTICO P/ BERÇO','POLI-LEO ESTAMPADO 310','MT','0.55');	
INSERT INTO INSUMOS VALUES('347','TECIDO TNT 45 GR','TNT 45 GRAMAS 975','M2','0.61');	

select * from insumos


INSERT INTO LINHABABYPOP60X130X08 VALUES(282,'0.0624','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(347,'0.8184','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(347,'0.3880','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(211,'1.0000','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(114,'1.0000','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(239,'7.7600','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(252,'1.0000','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(303,'0.62','','')

INSERT INTO LINHABABYPOP60X130X08 VALUES(282,'2','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(347,'3','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(347,'4','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(211,'1','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(114,'1','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(239,'7','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(252,'1','','')
INSERT INTO LINHABABYPOP60X130X08 VALUES(303,'62','','')


SELECT * FROM LINHABABYPOP60X130X08;


SELECT INSUMOS.*, 
           LINHABABYPOP60X130X08.QTD_INSUMO,
           LINHABABYPOP60X130X08.PRECO_TOTAL_INSUMO,
           LINHABABYPOP60X130X08.PRECO_TOTAL_PRODUTO FROM INSUMOS  INNER JOIN LINHABABYPOP60X130X08 
           ON INSUMOS.COD_INSUMO = LINHABABYPOP60X130X08.COD_INSUMO
           ORDER BY INSUMOS.COD_INSUMO


SELECT LINHABABYPOP60X130X08.*,
           INSUMOS.PRECO_INSUMO,
           LINHABABYPOP60X130X08.QTD_INSUMO * INSUMOS.PRECO_INSUMO 
FROM   LINHABABYPOP60X130X08 INNER JOIN INSUMOS 
          ON LINHABABYPOP60X130X08.COD_INSUMO = INSUMOS.COD_INSUMO
 ORDER BY INSUMOS.COD_INSUMO 


SELECT IMS.COD_INSUMO,
           IMS.NOME_INSUMO,
           ISNULL(ROUND(IMS.PRECO_INSUMO,0) * ROUND(LIN.QTD_INSUMO,0),0.00) AS "Preço do Insumo",
           SUM(ISNULL(ROUND(IMS.PRECO_INSUMO,0) * ROUND(LIN.QTD_INSUMO,0),0.00)) AS "Total Preço do Insumo"
           FROM INSUMOS IMS INNER JOIN LINHABABYPOP60X130X08 LIN
                                       ON IMS.COD_INSUMO = LIN.COD_INSUMO
GROUP BY IMS.COD_INSUMO, IMS.NOME_INSUMO,IMS.PRECO_INSUMO,LIN.QTD_INSUMO
ORDER BY IMS.COD_INSUMO

SELECT SUM(LINHABABYPOP60X130X08.TOTAL_PRECO_INSUMO) AS [TOTAL_PRECO_PRODUTO]  
